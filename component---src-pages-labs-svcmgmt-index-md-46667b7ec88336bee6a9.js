(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{T21n:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return l})),n.d(t,"default",(function(){return m}));var a=n("k1TG"),o=n("8o2o"),i=(n("q1tI"),n("7ljp")),r=n("013z"),l=(n("qKvR"),{}),c=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(i.b)("div",t)}},s=c("FeatureCard"),b=c("AnchorLinks"),d=c("AnchorLink"),p={_frontmatter:l},h=r.a;function m(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(i.b)(h,Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)(s,{title:"Managing edge services with the IBM Edge Application Manager",color:"dark",mdxType:"FeatureCard"},Object(i.b)("img",{src:"/images/agent-banner.jpg",alt:"banner"})),Object(i.b)(b,{mdxType:"AnchorLinks"},Object(i.b)(d,{mdxType:"AnchorLink"},"Lab Overview"),Object(i.b)(d,{mdxType:"AnchorLink"},"Prerequisite"),Object(i.b)(d,{mdxType:"AnchorLink"},"Business Context"),Object(i.b)(d,{mdxType:"AnchorLink"},"Create API key"),Object(i.b)(d,{mdxType:"AnchorLink"},"Install the agent"),Object(i.b)(d,{mdxType:"AnchorLink"},"Summary")),Object(i.b)("hr",null),Object(i.b)("h2",null,"Lab Overview"),Object(i.b)("p",null,"IBM Cloud Pak for Multicloud Management provides consistent visibility, automation, and governance across a range of multicloud management capabilities such as cost and asset management, infrastructure management, application management, multi-cluster management, edge management, and integration with existing tools and processes. Customers can leverage Cloud Pak for Multicloud Management to simplify their IT and application ops management, while increasing flexibility and cost savings with intelligent data analysis driven by predictive signals."),Object(i.b)("p",null,"IBM Cloud Pak for Multicloud Management can manage Kubernetes clusters that are deployed on any target infrastructure - either in your own data center or in a public cloud."),Object(i.b)("p",null,"In this tutorial, you will explore the following key capabilities:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"Understand Cloud Pak for Multicloud Management")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"Learn how to add a managed cluster")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"learn how to gather monitoring metrics from the managed cluster")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"Learn how to deploy an application to the managed cluster"))),Object(i.b)("hr",null),Object(i.b)("h2",null,"Prerequisite"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"You need to provision your own IBM Edge Application Manager Trial, start it and verify for correct startup (check ",Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"../../gettingstarted/"}),"here"),").")),Object(i.b)("hr",null),Object(i.b)("h2",null,"Business Context"),Object(i.b)("p",null,"Edge computing combined with 5G creates tremendous opportunities for new products, platforms, and experiences in every industry. Edge brings computation and data storage closer to where data is created by people, places and things - to enable faster insights and actions, reduce data exposure and maintain continuous operations. By 2025, 75 percent of enterprise data will be processed at the Edge, compared to only 10 percent today. IBM extends cloud computing to the Edge, with autonomous management capabilities that address new challenges of massive scale, variability, and rate of change - in enterprises and in telcos. ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.ibm.com/cloud/edge-application-manager"}),"IBM Edge Application Manager")," runs on Red Hat OpenShift, the leading open hybrid multicloud platform that runs anywhere - from any data center, to multiple clouds, to the edge."),Object(i.b)("h2",null,"Takeaways"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Understand IBM Edge Application Manager")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Learn how to add and configure edge nodes")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Learn how to register a new edge workloads (services)")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Learn how to enable autonomous management with policies"))),Object(i.b)("h2",null,"Prerequisites"),Object(i.b)("p",null,"This tutorial assume that you have already installed agent on edge device and registered the node to the IBM Edge Application Manager management hub. If you haven’t done it yet, please complete first the ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"/edge-demohub/dc764ba5ff33feb2782978da849f362a/index.mdx"}),"Installing IEAM agent tutorial")),Object(i.b)("hr",null),Object(i.b)("h3",null,"Scenario Introduction"),Object(i.b)("p",null,"ACME Grocery wants to deliver a new user experience in their stores."),Object(i.b)("p",null,"ACME Grocery is a retail chain that recently started a project to modernize its stores to enhance customer experience and achieve cost savings adopting some of the modern AI-based technologies. In the first phase of the project, the retail chain is deploying smart devices in its locations distributed across the country."),Object(i.b)("p",null,"There are two types of devices to be managed:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("strong",{parentName:"p"},"Smart shopping carts")," (also known aa “smartcarts”)")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},Object(i.b)("strong",{parentName:"p"},"Smart scales")," for weighting unpackaged goods, which automatically\ndetect what is being weighted to apply correct price (smart camera\nwith AI-based visual recognition)"))),Object(i.b)("p",null,"In this scenario, you are the Operations team engineer responsible for managing the smart devices at scale."),Object(i.b)("hr",null),Object(i.b)("h3",null,"Registering the edge-device as \\“smartcart\\”"),Object(i.b)("p",null,"To start deploying actual workloads to the test device you need to register it with the properties of the target device. Let\\‘s start with the \\“smartcart\\” type. The files needed for further exercises were already placed on the edge-device in the ","~","/edge-demo directory.\nTo collect the latest version of the files, run the following commands"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"cd ~/edge-demo \ngit pull\n")),Object(i.b)("p",null,"Optionally, you can run the following command to enable subcommand name completion "),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),'cat "source /etc/bash_completion.d/hzn_bash_autocomplete.sh" >> ~/.bashrc\n')),Object(i.b)("p",null,"If you do this step, close and re-open the terminal window."),Object(i.b)("p",null,"Steps"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"To change the node type and node properties, you need to first unregister the device from the IBM Edge Application Manager server. This activity is done usually only in the development and testing phase. In real life, the physical edge devices get their configuration during the initial install process.")),Object(i.b)("p",null,"To unregister device run the following command in the Terminal window opened on “edge-device” virtual machine"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"hzn unregister -f\n")),Object(i.b)("ol",{start:2},Object(i.b)("li",{parentName:"ol"},"To define the node as “smartcart” you need to specify the node properties and constraints during registration. This is done using a JSON file containing the node policy. The sample file was already prepared for you. List the content of the file with the following command:")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"cat ~/edge-demo/smartcart/smartcart-node-registration.json \n")),Object(i.b)("p",null,"Output will look like:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),'{\n  "properties": [\n    {\n      "name": "smartcart",\n      "value": true\n    },\n    {\n      "name": "location",\n      "value": "3801 S Las Vegas Blvd, NV 89109, USA"\n    },\n    {\n      "name": "type",\n      "value": "SmartCart1"\n    }\n  ],\n  "constraints": [\n    "purpose == battery-monitor OR purpose == content-monitor"\n  ]\n}\n')),Object(i.b)("ol",{start:3},Object(i.b)("li",{parentName:"ol"},"To register the node, run the following command")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"hzn register --policy=/home/localuser/edge-demo/smartcart/smartcartnode-registration.json\n")),Object(i.b)("p",null,"Output should look like below:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"Horizon Exchange base URL:\nhttps://icp-console.10.0.10.2.nip.io/ecexchange/v1 Using node ID 'edge-device' from the Horizon agent\n\nGenerated random node token Upating node token\\...\n\nWill proceeed with the given node policy.\n\nUpdating the node policy\\...\n\nInitializing the Horizon node\\... Warning: no input file was specified. This is only valid if none of t he services need variables set (including GPS coordinates). However, if there is \\'useInput\\' specified in the node already in the exchange, the useInput will be used.\n\nChanging Horizon state to configured to register this node with Horizon\\... Horizon node is registered. Workload agreement negotiation should beg in shortly. Run \\'hzn agreement list\\' to view.\n")),Object(i.b)("ol",{start:4},Object(i.b)("li",{parentName:"ol"},"Let’s look back at the IBM Edge Application Manager console. After 1-2 minutes, when you refresh the Nodes view you should see the following view")),Object(i.b)("img",{src:".//media/image17.jpg",alt:null}),Object(i.b)("p",null,"You can run the “hzn agreement list” and “docker ps” commands in the Terminal window again to verify that the services were actually started at the device."),Object(i.b)("h3",null,"Working with services"),Object(i.b)("p",null,"Services represent the software that is being deployed on the edge - they represent specific functions that you install on the managed devices. There are specialized services, like contentmonitor service that reads the NFC sensor installed in the smart shopping cart to control the value of the goods put in the basket. There are more generic ones. For example, to monitor if the CPU on the edge device is not overloaded with other workloads."),Object(i.b)("p",null,"Let’s look at the services defined in the environment and check their requirements"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Open the Service tab in the IBM Edge Application Manager interface (go back to the Nodes tab with the Nodes link in the top-left corner and then select the ",Object(i.b)("strong",{parentName:"p"},"Services")," tab)")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Notice there are many different services owned by different users. Each version of the service represents a specific version of the Docker container to be running on the edge nodes. Click the ’",Object(i.b)("strong",{parentName:"p"},"ibm.cpu"),"’ service."))),Object(i.b)("img",{src:".//media/image18.jpg",alt:null}),Object(i.b)("p",null,"You can see that this utility service designed to monitor CPU load is available for different processor architectures: arm, arm64, and amd64 (x86_64)."),Object(i.b)("img",{src:".//media/image19.jpg",alt:null}),Object(i.b)("p",null,"This service can be installed on the devices to control that the other services that use compute-intensive machine learning models do not overload the device."),Object(i.b)("ol",{start:3},Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Click the search box (",Object(i.b)("strong",{parentName:"p"},"Find services"),"), select the ”",Object(i.b)("strong",{parentName:"p"},"Service ID"),"” as the filter and type ",Object(i.b)("strong",{parentName:"p"},"battery")," to find the service that is currently running on the edge device.\n",Object(i.b)("img",Object(a.a)({parentName:"p"},{src:".//media/image20.png",alt:null})))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Click the service tile (",Object(i.b)("strong",{parentName:"p"},"battery-service"),") to see the details of the service definition."))),Object(i.b)("img",{src:".//media/image21.jpg",alt:null}),Object(i.b)("ol",{start:5},Object(i.b)("li",{parentName:"ol"},"Look at the service properties and constraints. Notice there is a “battery-monitor-deployment” policy in Deployment section.")),Object(i.b)("img",{src:".//media/image22.jpg",alt:null}),Object(i.b)("p",null,"This view provides you with the information where the service potentially can be deployed (for example, how much memory is needed and so on), and list the policies that already govern the deployment of this service to devices."),Object(i.b)("ol",{start:6},Object(i.b)("li",{parentName:"ol"},"Similarly, you can find the other service that runs on your smart cart device. Click the ",Object(i.b)("strong",{parentName:"li"},"Services")," link in the top-left corner to go back to the Services tab, find the service named ",Object(i.b)("strong",{parentName:"li"},"smartcart-service")," (you should already know how to use Search field) and open the details for it."),Object(i.b)("li",{parentName:"ol"},"It seems the applications designed to be placed on the smartcart devices are working OK. Let\\‘s check what happens if you register test device as smart scale")),Object(i.b)("h3",null,"Register a node as smartscale"),Object(i.b)("p",null,"In this section, you will register the test device as a smart scale to check if the services meant to be running at this type of device are properly defined. Since you have done many of the actions before are providing just a brief instruction."),Object(i.b)("p",null,"Steps"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Unregister the edge node.")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Register the edge node again using the /home/localuser/edge-demo/smartscale/smartscale-node-registration.json file")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Check the agreements and docker containers running at the edge device (be patient - it can take 1-2 minutes for the agreement to be negotiated and workload to be placed on the node)")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"You can notice that now only one service is running on the device. Do you know why? Let’s check why the “acmegrocery/smartcart-service_1.0.0_amd64” is not being deployed.")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"Run the following in the Terminal window"))),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),'hzn deploycheck policy -b "acmegrocery/smartcart-v1-deployment"\n')),Object(i.b)("p",null,"You should see the following output:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),'Neither node id nor node policy is specified. Getting node policy fro m the local node. {\n\n\\"compatible\\": false,\n\n\\"reason\\": {\n\n\\"acmegrocery/smartcartservice\\_1.0.0\\_amd64\\": \\"Policy Incompatible:\nCompatibility Error: Node properties do not satisfy constraint\nrequirements. The required properties smartcart==true were not found\nin the available properties smartscale=true,\nlocation=Fresh\\_Vegetables, type=SmartScale-Video-An alytics-1000,\nopenhorizon.hardwareId=1c684047a8a3607c04fd409e4d02f1ad 96471d6f,\nopenhorizon.cpu=4, openhorizon.arch=amd64, openhorizon.memo ry=3951,\nopenhorizon.allowPrivileged=false\\" }\n\n}\n')),Object(i.b)("p",null,"When working with the IBM Edge Application Manager this command helps you find out if the policies that you define are compatible with the nodes registered in the system."),Object(i.b)("h3",null,"Defining a new deployment policy"),Object(i.b)("p",null,"Let’s now define a new deployment policy that will distributes software that should be deployed to smart scale devices. In this exercise, you learn how to effectively use the mechanism of properties and constraints to get the right software to the right devices in an autonomous fashion."),Object(i.b)("p",null,"Steps"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"In the IBM Edge Application Manager interface, find the service named “smartscale-service”. Open the details for the service")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"You can notice that there is no deployment policy defined for that service. Let’s create one. Click ",Object(i.b)("strong",{parentName:"p"},"Create deployment policy"),"."))),Object(i.b)("img",{src:".//media/image23.jpg",alt:null}),Object(i.b)("ol",{start:3},Object(i.b)("li",{parentName:"ol"},"Provide the policy name and description. Notice that the service name and version are already defined, as you initiated the policy creation from the service context. Click ",Object(i.b)("strong",{parentName:"li"},"Next")," to proceed.")),Object(i.b)("img",{src:".//media/image24.jpg",alt:null}),Object(i.b)("ol",{start:4},Object(i.b)("li",{parentName:"ol"},"In the second step you need to define which devices should be targeted for deployment. You can use any of the properties defined for the edge nodes. For the scenario let’s use the “smartscale” “is equal” “true”. Enter the values and click ",Object(i.b)("strong",{parentName:"li"},"Next"),".")),Object(i.b)("img",{src:".//media/image25.jpg",alt:null}),Object(i.b)("ol",{start:5},Object(i.b)("li",{parentName:"ol"},"You don’t need to change anything on the Advance settings tab, so just click ",Object(i.b)("strong",{parentName:"li"},"Next")," and then in the Summary page click ",Object(i.b)("strong",{parentName:"li"},"Deploy service"))),Object(i.b)("img",{src:".//media/image26.jpg",alt:null}),Object(i.b)("ol",{start:6},Object(i.b)("li",{parentName:"ol"},"Let’s verify that the service was successfully deployed. Go back to termial window (or open new one using the shortcut on the desktop) and check the agreements and running containers. (If you forgot how to do this, look back to the step 4 in ",Object(i.b)("strong",{parentName:"li"},"Registering the edgedevice as “smartcart”")," section above).")),Object(i.b)("p",null,"You can also verify the results in UI, looking at the details of edge-device node"),Object(i.b)("img",{src:".//media/image27.jpg",alt:null}),Object(i.b)("p",null,"Congratulations! Your deployment policy is working! Any new smartscale device connected to the IBM Edge Application Manager hub will get the service deployed automatically."),Object(i.b)("h3",null,"Summary"),Object(i.b)("p",null,"ACME Grocery is ready to start with the rollout of smart devices to the stores. Great job! If you want to explore more advanced functionalities of IBM Edge Application Manager, try the following resources:"),Object(i.b)("ul",null,Object(i.b)("li",null,Object(i.b)("a",{href:"https://www.ibm.com/cloud/blog/models-deployed-at-the-edge"},"Blog on Machine Learning model management at the edge")),Object(i.b)("li",null,Object(i.b)("a",{href:"https://github.com/open-horizon/examples/tree/master/edge/services/helloMMS"},"Tutorial to play with helloMMS example")),Object(i.b)("li",null,Object(i.b)("a",{href:"https://www.ibm.com/support/knowledgecenter/pl/SSFKVV_4.0/devices/developing/developing.html"},"Developing edge services with IBM Edge Application Manager"))))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-labs-svcmgmt-index-md-46667b7ec88336bee6a9.js.map